# RID Qualifier Tests

This directory contains a series of tests for qualifying Network Remote ID compliance. It will contain four things:

1. **Flight track dataset generator** (`flight_data_generator.py`): An API to generate multiple flight paths and patterns within a specified bounding box. You can specify a bounding box in any part of the world the generator will create a grid for flights for the bounds provided. In addition, circular flight paths will be generated within that grid. The output of this API are flight data file artifacts in GeoJSON [FeatureCollection](https://tools.ietf.org/html/rfc7946#section-3.3) format. In addition to the flight tracks, query bounding boxes are also generated as a GeoJSON FeatureCollection format. Finally the flight tracks are converted to a `RIDAircraftState` data: by adding metadata and timestamps to the points. The conversion of flight track points to RIDAircraftState can be considered as a simplified simulation. All the files, once generated are stored in the `test_definitions` directory.

2. **Aircraft state replayer** (`aircraft_state_replayer.py`): Using the flight data generated by the previous tool, we simulate flights and "fly" them by emitting aircraft states to be fed to the Remote ID Service Provider test harnesses. Specific details and metadata about the flights are included when submitting to the SP test harnesses via the injection API.

3. **Test executor**: (`test_executor.py`) The test executor is  the main routine of `rid_qualifier`: it instructs the `aircraft_state_replayer` to send test data into each SP's injection harness, and then asks the `display_data_evaluator` to query the RID system for expected data and evaluate the query results against expectations to produce qualification results.

4. **Display Data Evaluator**: Once test aircraft state data is sent to each Remote ID Service Provider's injection test harness to be injected into their systems, the state of the RID system must be queried and then the results of those queries compared against expected results.  This module performs the latter tasks of querying the RID system through each specified Remote ID Display Provider's ingestion test harness, and comparing those query results against expectations. [Flight Blender](https://github.com/openskies-sh/flight-blender) is an open-source Remote ID Display Provider that will implement an ingestion test harness, and therefore can be used to test compliance.

## Building the image

From the `root folder of this repo` folder, build the image:

```shell script

docker build \
    -f monitoring/rid_qualifier/Dockerfile \
    -t interuss/dss/rid_qualifier \
    --build-arg version=`scripts/git/commit.sh` \
    monitoring

```

### Invocation

```shell script

docker run --name rid_qualifier \
   --rm \   
   -v "$(pwd)"/test_definitions:/test_definitions \
   interuss/dss/rid_qualifier \ 
   --auth=<SPEC> \
   --dss=https://example.com \
   --locale=che \
   --injection_url=https://dss.unmanned.corp/tests \
    
```

The auth SPEC defines how to obtain access tokens to access the DSS instances and USSs in the network. See [the auth spec documentation](../monitorlib/README.md#Auth_specs) for examples and more information.
