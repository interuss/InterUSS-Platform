# RID Qualifier Host

`rid_qualifier host` is a development-level web server that provides endpoint to initialize the automated testing of the rid qualifier. 
This PR includes the initial setup for the web-server that can be run locally on your system via the (run_locally.sh)[run_locally.sh] script. 

## About

This project will create the following environment:

* redis Container: A redis server to handle background tasks.

* rq-worker Container: A container to run redis queue worker processes.

* rid-host Container: A flask application which accepts flight states' files, collect auth and config spec from user and executes RID Qualifier task. Once task finishes successfully, report.json file is available to download.

* Additionally, you need to bring up (rid_qualifier mock instance)[../mock/run_locally.sh] to produce a mock RID system for use with rid_qualifier. The instructions to bring up the rid_qualifier mock instance can be found (here)[monitoring/rid_qualifier/mock/README.md].

## Run via Docker

Change the root directory to dss/. Run the following command to start new containers:

```bash
 ./monitoring/rid_qualifier/host/run_locally.sh
```

## Task Description

You can now test the application by uploading flight states json files. There must be at least one such input json file w.r.t each USS target provided in [Configuration object below](#user-config-information).
Input files are **required** to execute the task. Follow the instructions below to generate [Flight states input files](#flight-states-input-files). 

## Flight states input files

RID host requires flight state input files to run the test executor. These files can be generated by running (flight_data_generator)[monitoring/rid_qualifier/flight_data_generator.py] as below:

```bash
    python monitoring/rid_qualifier/flight_data_generator.py
```

Resulting files will be generated under `monitoring/rid_qualifier/test_definitions/che/aircraft_states`.

## User Config information

rid_qualifier host needs a configuration object and an auth spec (single string e.g. `NoAuth()`) in order to run. Configuration object is a simple nested json string which should have at least a list of `injection_targets` and `observers`. A sample configuration object can be found (here)[https://github.com/interuss/dss/blob/48ce96b1a50603b810ead672a7c8dbca4a7c367c/monitoring/rid_qualifier/run_locally.sh#L18].

A task may take few minutes to finish. A new task can not be launched until current task ends.

Once the task is successful, resulting report can be retrieved from the web interface by clicking the `Get Result` button. A sample response report.json can be downloaded by ticking `Sample Report` checkbox.
